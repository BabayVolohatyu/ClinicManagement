@model ClinicManagement.Services.PaginatedResult<ClinicManagement.Models.Facilities.CabinetType>

@{
    ViewData["Title"] = "Cabinet Types";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Cabinet Types</h2>
    <a asp-action="Create" class="btn btn-success">+</a>
</div>

@if (!Model.Items.Any())
{
    <div class="alert alert-info text-center">
        No cabinet types found.
    </div>
}
else
{
    <table class="table table-hover table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Type</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Items)
            {
                <tr class="clickable-row" data-href="@Url.Action("Entity", new { id = item.Id })">
                    <td>@item.Id</td>
                    <td>@item.Type</td>
                </tr>

            }
        </tbody>
    </table>

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item @(!Model.HasPrevious ? "disabled" : "")">
                <a class="page-link" 
                   href="@Url.Action("Index", new { pageNumber = Model.PageNumber - 1, pageSize = Model.PageSize })" 
                   aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            <!-- Page numbers -->
            @for (int i = 1; i <= Model.TotalPages; i++)
            {
                <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                    <a class="page-link" 
                       href="@Url.Action("Index", new { pageNumber = i, pageSize = Model.PageSize })">
                        @i
                    </a>
                </li>
            }

            <!-- Next page -->
            <li class="page-item @(!Model.HasNext ? "disabled" : "")">
                <a class="page-link" 
                   href="@Url.Action("Index", new { pageNumber = Model.PageNumber + 1, pageSize = Model.PageSize })" 
                   aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Page info and size selector -->
    <div class="row justify-content-between align-items-center mt-3">
        <div class="col-auto">
            <small class="text-muted">
                Showing @((Model.PageNumber - 1) * Model.PageSize + 1) to 
                @Math.Min(Model.PageNumber * Model.PageSize, Model.TotalCount) of 
                @Model.TotalCount entries
            </small>
        </div>
        <div class="col-auto">
            <label for="pageSizeSelect" class="form-label mb-0">Items per page:</label>
            <select class="form-select form-select-sm d-inline-block w-auto" 
                    id="pageSizeSelect" 
                    onchange="changePageSize(this.value)">
                <option value="5" selected="@(Model.PageSize == 5)">5</option>
                <option value="10" selected="@(Model.PageSize == 10)">10</option>
                <option value="25" selected="@(Model.PageSize == 25)">25</option>
                <option value="50" selected="@(Model.PageSize == 50)">50</option>
            </select>
        </div>
    </div>
}

@section Scripts {
    <script>
        function changePageSize(pageSize) {
            window.location.href = '@Url.Action("Index")' + '?pageNumber=1&pageSize=' + pageSize;
        }

        document.addEventListener("DOMContentLoaded", function () {
            const rows = document.querySelectorAll(".clickable-row");
            rows.forEach(row => {
                row.addEventListener("click", () => {
                    const href = row.getAttribute("data-href");
                    if(href) window.location.href = href;
                });
            });
        });
    </script>
}
